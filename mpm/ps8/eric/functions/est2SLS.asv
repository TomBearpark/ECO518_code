function est2SLS(Z, X, y)
% est2SLS()  Estimate 2SLS. Use Hayashi notation.
% Input:
%  - Z endogenous variables
%  - X instruments
%  - y dependent variable

[n, kx] = size(X);
[~, kz] = size(Z);


Sxx = X'*X;
Sxz = X'*Z;


deltaHat = (Sxz' * (Sxx \ Sxz)) \ Sxz' * (Sxx \ X'*y);
e   = y - Z*deltaHat;  % Residual

G     = X'*Z/n;  % partial g / partial delta
W     = X'*X/n; % Weight matrix under 2SLS
Omega = [e; e]* X;


end